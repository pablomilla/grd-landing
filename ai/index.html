<!-- SIMPLIFIED VERSION — MANUAL CAPTURE ONLY -->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#ffffff" />
  <title>grd. — AI Grade</title>

  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">

  <style>
    :root{
      --bg:#ffffff;
      --fg:#0b0f14;
      --muted:#5f6b7a;
      --line:rgba(11,15,20,.12);
      --shadow:0 22px 70px rgba(11,15,20,.12);
      --radius:24px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto;
      background:#fff;
      color:var(--fg);
    }

    header{
      padding:26px 24px;
      max-width:1100px;
      margin:0 auto;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    .logo{font-weight:900;letter-spacing:-.05em;font-size:28px}
    .pill{
      padding:10px 14px;
      border-radius:999px;
      border:1px solid var(--line);
      font-size:13px;
      color:var(--muted);
    }

    main{
      max-width:1100px;
      margin:0 auto;
      padding:24px;
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:24px;
    }

    @media(max-width:900px){
      main{grid-template-columns:1fr}
    }

    .panel{
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:24px;
      box-shadow:var(--shadow);
      background:#fff;
    }

    h1{
      margin:0 0 8px;
      font-size:34px;
      letter-spacing:-.05em;
    }

    .sub{
      color:var(--muted);
      font-size:14px;
      margin-bottom:20px;
      line-height:1.6;
    }

    .btn{
      padding:12px 16px;
      border-radius:14px;
      border:1px solid rgba(11,15,20,.2);
      background:#0b0f14;
      color:#fff;
      font-weight:700;
      cursor:pointer;
      font-size:14px;
    }

    .btn.secondary{
      background:#fff;
      color:#0b0f14;
    }

    input[type="file"]{display:none}

    .preview{
      margin-top:16px;
      border-radius:20px;
      border:1px solid var(--line);
      overflow:hidden;
    }

    .preview img{
      width:100%;
      aspect-ratio:3/4;
      object-fit:cover;
    }

    .meta{
      padding:10px;
      font-size:12px;
      color:var(--muted);
    }

    .grade{
      font-size:44px;
      font-weight:900;
      letter-spacing:-.06em;
    }

  </style>
</head>

<body>

<header>
  <div class="logo">grd.</div>
  <div class="pill">AI grading</div>
</header>

<main>

  <!-- LEFT -->
  <div class="panel">
    <h1>Upload front + back</h1>
    <p class="sub">
      Use your camera or upload photos. Make sure the card fills the frame and glare is minimal.
    </p>

    <label class="btn" for="frontFile">Upload Front</label>
    <label class="btn secondary" for="backFile">Upload Back</label>

    <input id="frontFile" type="file" accept="image/*" capture="environment">
    <input id="backFile" type="file" accept="image/*" capture="environment">

    <div class="preview">
      <img id="frontImg" />
      <div class="meta" id="frontMeta">Front: —</div>
    </div>

    <div class="preview">
      <img id="backImg" />
      <div class="meta" id="backMeta">Back: —</div>
    </div>

    <button class="btn" id="gradeBtn" disabled style="margin-top:16px;">
      Run AI Grade
    </button>
  </div>

  <!-- RIGHT -->
  <div class="panel">
    <div class="grade" id="grade">—</div>
    <div id="notes" class="sub">
      Upload both sides to generate a grade.
    </div>
  </div>

</main>

<script>
  const frontFile = document.getElementById('frontFile');
  const backFile = document.getElementById('backFile');
  const frontImg = document.getElementById('frontImg');
  const backImg = document.getElementById('backImg');
  const frontMeta = document.getElementById('frontMeta');
  const backMeta = document.getElementById('backMeta');
  const gradeBtn = document.getElementById('gradeBtn');
  const gradeEl = document.getElementById('grade');
  const notesEl = document.getElementById('notes');

  let front = null;
  let back = null;

  function updateButton(){
    gradeBtn.disabled = !(front && back);
  }

  frontFile.onchange = e=>{
    front = e.target.files[0];
    if(front){
      frontImg.src = URL.createObjectURL(front);
      frontMeta.textContent = front.name;
    }
    updateButton();
  };

  backFile.onchange = e=>{
    back = e.target.files[0];
    if(back){
      backImg.src = URL.createObjectURL(back);
      backMeta.textContent = back.name;
    }
    updateButton();
  };

  gradeBtn.onclick = async ()=>{
    gradeEl.textContent = "…";
    notesEl.textContent = "Analyzing…";

    const frontData = await fileToBase64(front);
    const backData = await fileToBase64(back);

    const res = await fetch("/api/grade",{
      method:"POST",
      headers:{ "Content-Type":"application/json"},
      body:JSON.stringify({frontDataUrl:frontData, backDataUrl:backData})
    });

    const data = await res.json();
    gradeEl.textContent = data.overall?.toFixed(1) || "—";
    notesEl.textContent = (data.notes || []).join(", ");
  };

  function fileToBase64(file){
    return new Promise(resolve=>{
      const reader = new FileReader();
      reader.onload = ()=> resolve(reader.result);
      reader.readAsDataURL(file);
    });
  }
</script>

</body>
</html>
